<div class="wrap">
  <div class="card">
    <div class="logo-frame">
      <img src="assets/Logo.png" alt="EasyTrufi" class="logo-img">
    </div>

    <h1>EasyTrufi</h1>
    <p class="sub">Bienvenido de nuevo</p>

    <div class="alt-mode">
      <button type="button" class="link" (click)="useCard = !useCard">
        {{ useCard ? 'Usar email y contraseÃ±a' : 'Ingresar con tarjeta (UID)' }}
      </button>
    </div>

    <!-- Login  -->
    <form *ngIf="!useCard" [formGroup]="form" (ngSubmit)="onSubmit()" novalidate>
      <div class="field">
        <label for="email">Email</label>
        <input id="email" type="email" formControlName="email"
               placeholder="tu@email.com"
               [class.invalid]="f.email.touched && f.email.invalid" />
        <small *ngIf="f.email.touched && f.email.errors?.['required']">El email es obligatorio.</small>
        <small *ngIf="f.email.touched && f.email.errors?.['email']">Formato de email no vÃ¡lido.</small>
      </div>

      <div class="field">
        <label for="password">ContraseÃ±a</label>
        <div class="password">
          <input id="password" [type]="hide ? 'password' : 'text'" formControlName="password"
                 placeholder="********"
                 [class.invalid]="f.password.touched && f.password.invalid" />
          <button type="button" class="toggle" (click)="togglePassword()" aria-label="Mostrar/ocultar contraseÃ±a">
            {{ hide ? 'ğŸ‘ï¸' : 'ğŸ™ˆ' }}
          </button>
        </div>
        <small *ngIf="f.password.touched && f.password.errors?.['required']">La contraseÃ±a es obligatoria.</small>
        <small *ngIf="f.password.touched && f.password.errors?.['minlength']">Debe tener al menos 6 caracteres.</small>
      </div>

      <div class="row">
        <label class="remember">
          <input type="checkbox" formControlName="remember" />
          Recordarme
        </label>
        <a routerLink="/" class="link">Â¿Olvidaste tu contraseÃ±a?</a>
      </div>

      <button class="btn btn-primary" type="submit" [disabled]="loading || form.invalid">
        {{ loading ? 'Ingresandoâ€¦' : 'Iniciar sesiÃ³n' }}
      </button>

      <p class="hint">
        Â¿No tenÃ©s cuenta?
        <a routerLink="/registro" class="link">Crear cuenta</a>
      </p>
    </form>

    <!-- Login por tarjeta -->
    <form *ngIf="useCard" [formGroup]="uidForm" (ngSubmit)="onSubmitCard()" novalidate>
      <div class="field">
        <label for="uidTarjeta">UID de la tarjeta</label>
        <input id="uidTarjeta" type="text" formControlName="uidTarjeta" placeholder="Ej. 04A2-7F9C-1B" />
        <small *ngIf="uidForm.get('uidTarjeta')?.touched && uidForm.get('uidTarjeta')?.invalid">
          IngresÃ¡ el UID de tu tarjeta.
        </small>
      </div>

      <button class="btn btn-primary" type="submit" [disabled]="loading || uidForm.invalid">
        {{ loading ? 'Verificandoâ€¦' : 'Ingresar con tarjeta' }}
      </button>

      <p class="hint">
        Â¿No tenÃ©s cuenta?
        <a routerLink="/registro" class="link">Crear cuenta</a>
      </p>
    </form>

    <p class="error" *ngIf="errorMsg">{{ errorMsg }}</p>
  </div>
</div>
